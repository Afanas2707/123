databaseChangeLog:
  - changeSet:
      id: create-organization-table
      author: Alexey Afanasievskiy
      createTable:
        tableName: organization
        columns:
          - column:
              name: id
              type: uuid
              defaultValueComputed: uuid_generate_v4()
              constraints:
                primaryKey: true
                nullable: false
          - column:
              name: name
              type: varchar(255)
              constraints:
                nullable: false
          - column:
              name: created_by
              type: VARCHAR(255)
          - column:
              name: created_date
              type: TIMESTAMP WITH TIME ZONE
          - column:
              name: last_updated_by
              type: VARCHAR(255)
          - column:
              name: last_updated_date
              type: TIMESTAMP WITH TIME ZONE
  - changeSet:
      id: create-organization_id-for-user-table
      author: Alexey Afanasievskiy
      addColumn:
        tableName: user
        columns:
          - column:
              name: organization_id
              type: uuid
              constraints:
                nullable: true
      addForeignKeyConstraint:
        baseTableName: user
        baseColumnNames: organization_id
        referencedTableName: organization
        referencedColumnNames: id
        constraintName: fk_user_organization
        onDelete: SET NULL
        onUpdate: CASCADE
        deferrable: true
        initiallyDeferred: true